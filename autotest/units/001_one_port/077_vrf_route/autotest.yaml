steps:

- ipv4LabelledUpdate:
  - "200.0.20.2/32 -> 200.0.20.1:112"
- cli:
    - rib static insert default 0.0.0.0/0 200.0.10.1
    - rib static insert default 1.0.0.0/24 200.0.20.1
    - rib static insert default 2.0.0.0/24 200.0.40.1
    - rib static insert red 0.0.0.0/0 200.0.30.1
    - rib static insert red 1.0.0.0/24 200.0.10.1
    - rib static insert red 2.0.0.0/24 200.0.20.1
    - rib static insert white 1.0.0.0/24 200.0.40.1
    - rib static insert white 1.0.0.16/28 200.0.10.1
    - rib static insert white 1.0.0.16/30 200.0.20.2

- cli:
    - rib static insert default ::/0 c0de::10:1
    - rib static insert default 7e01::/64 c0de::20:1
    - rib static insert default 7e02::/64 c0de::40:1
    - rib static insert red ::/0 c0de::30:1
    - rib static insert red 7e01::/64 c0de::10:1
    - rib static insert red 7e02::/64 c0de::20:1
    - rib static insert white 7e01::/64 c0de::40:1
    - rib static insert white 7e01::/96 c0de::10:1
    - rib static insert white 7e01::/128 c0de::20:1

# - cli:
    # - rib prefixes
    # - route lookup red 1.0.0.1
    # - route lookup red 2.0.0.1
    # - route lookup red 3.0.0.1

- cli_check: |
    rib prefixes
    vrf      priority  prefix         protocol  peer     table_name  path_information  nexthop     labels  local_preference  aspath  origin      med  communities  large_communities
    -------  --------  -------------  --------  -------  ----------  ----------------  ----------  ------  ----------------  ------  ----------  ---  -----------  -----------------
    default  10000     0.0.0.0/0      static    ::                   200.0.10.1        200.0.10.1          0                                     0    n/s          n/s
    default  10000     1.0.0.0/24     static    ::                   200.0.20.1        200.0.20.1          0                                     0    n/s          n/s
    default  10000     2.0.0.0/24     static    ::                   200.0.40.1        200.0.40.1          0                                     0    n/s          n/s
    default  10000     200.0.20.2/32  autotest  0.0.0.0  ipv4 mpls   0:10001           200.0.20.1  112     0                         incomplete  0    n/s          n/s
    default  10000     ::/0           static    ::                   c0de::10:1        c0de::10:1          0                                     0    n/s          n/s
    default  10000     7e01::/64      static    ::                   c0de::20:1        c0de::20:1          0                                     0    n/s          n/s
    default  10000     7e02::/64      static    ::                   c0de::40:1        c0de::40:1          0                                     0    n/s          n/s
    default  10000     fe80::/64      static    ::                                     ::                  0                                     0    n/s          n/s
    red      10000     0.0.0.0/0      static    ::                   200.0.30.1        200.0.30.1          0                                     0    n/s          n/s
    red      10000     1.0.0.0/24     static    ::                   200.0.10.1        200.0.10.1          0                                     0    n/s          n/s
    red      10000     2.0.0.0/24     static    ::                   200.0.20.1        200.0.20.1          0                                     0    n/s          n/s
    red      10000     ::/0           static    ::                   c0de::30:1        c0de::30:1          0                                     0    n/s          n/s
    red      10000     7e01::/64      static    ::                   c0de::10:1        c0de::10:1          0                                     0    n/s          n/s
    red      10000     7e02::/64      static    ::                   c0de::20:1        c0de::20:1          0                                     0    n/s          n/s
    white    10000     1.0.0.0/24     static    ::                   200.0.40.1        200.0.40.1          0                                     0    n/s          n/s
    white    10000     1.0.0.16/28    static    ::                   200.0.10.1        200.0.10.1          0                                     0    n/s          n/s
    white    10000     1.0.0.16/30    static    ::                   200.0.20.2        200.0.20.2          0                                     0    n/s          n/s
    white    10000     7e01::/64      static    ::                   c0de::40:1        c0de::40:1          0                                     0    n/s          n/s
    white    10000     7e01::/96      static    ::                   c0de::10:1        c0de::10:1          0                                     0    n/s          n/s
    white    10000     7e01::/128     static    ::                   c0de::20:1        c0de::20:1          0                                     0    n/s          n/s

- sendPackets:
  - port: kni0
    send: 001-send.pcap
    expect: 001-expect.pcap

- sendPackets:
  - port: kni0
    send: 002-send.pcap
    expect: 002-expect.pcap
